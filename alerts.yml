groups:
  - name: pikaleads_alerts
    interval: 30s
    rules:
      # High memory usage alert
      - alert: HighMemoryUsage
        expr: pikaleads_memory_usage_percent > 85
        for: 5m
        labels:
          severity: warning
          service: pikaleads
        annotations:
          summary: "High memory usage detected"
          description: "Memory usage is {{ $value }}% (threshold: 85%)"
      
      # Critical memory usage alert
      - alert: CriticalMemoryUsage
        expr: pikaleads_memory_usage_percent > 95
        for: 2m
        labels:
          severity: critical
          service: pikaleads
        annotations:
          summary: "Critical memory usage detected"
          description: "Memory usage is {{ $value }}% (threshold: 95%)"
      
      # High CPU load alert
      - alert: HighCPULoad
        expr: pikaleads_cpu_load_1m > 2
        for: 5m
        labels:
          severity: warning
          service: pikaleads
        annotations:
          summary: "High CPU load detected"
          description: "CPU load average (1m) is {{ $value }} (threshold: 2.0)"
      
      # Database connection failure
      - alert: DatabaseDown
        expr: pikaleads_database_status == 0
        for: 1m
        labels:
          severity: critical
          service: pikaleads
        annotations:
          summary: "Database connection failed"
          description: "Database is unreachable or unhealthy"
      
      # Slow database response
      - alert: SlowDatabaseResponse
        expr: pikaleads_database_response_ms > 1000
        for: 3m
        labels:
          severity: warning
          service: pikaleads
        annotations:
          summary: "Slow database response time"
          description: "Database response time is {{ $value }}ms (threshold: 1000ms)"
      
      # High error rate
      - alert: HighErrorRate
        expr: rate(pikaleads_errors_24h[5m]) > 10
        for: 5m
        labels:
          severity: warning
          service: pikaleads
        annotations:
          summary: "High error rate detected"
          description: "Error rate is {{ $value }} errors/min (threshold: 10)"
      
      # Service down
      - alert: ServiceDown
        expr: up{job="pikaleads"} == 0
        for: 1m
        labels:
          severity: critical
          service: pikaleads
        annotations:
          summary: "PIKALEADS service is down"
          description: "The PIKALEADS application is not responding"
      
      # Low lead generation
      - alert: LowLeadGeneration
        expr: rate(pikaleads_leads_24h[1h]) < 1
        for: 2h
        labels:
          severity: warning
          service: pikaleads
        annotations:
          summary: "Low lead generation rate"
          description: "Lead generation rate is {{ $value }} leads/hour (threshold: 1)"
